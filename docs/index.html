<!DOCTYPE html>
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta name="viewport" content="width=device-width" />
      <link href="assets/bootstrap.min.css" rel="stylesheet" />
      <link href="assets/doc.css" rel="stylesheet" />
      <title>Generate XSL</title>
   </head>
   <body>
      <header></header>
      <main>
         <p class="update">Révisé le 01 Mars 2018<a class="project-repo" target="_blank" href="https://github.com/jimetevenard/generate-xsl">Generate XSL - GitHub</a></p>
         
         
         
         
         
         
         
         
         
         
         <h1>Generate XSL</h1>
         
         
         
         <section>
            
            
            <h2>Introduction</h2>
            
            
            <p> Generate-XSL est un langage d'annotions permettant de décrire la pré-compilation
               d'une
               transformation XSL, en pré-calculant certaines évaluations dans un but d'optimisation
               des performances. 
            </p>
            
            
            <p> Ces annotations s'expriment sous forme d'éléments et d'attributs XML appartenant
               au
               namespace <a href="#" class="namespace-ref" title="generate:http://jimetevenard.com/ns/generate-xsl">Generate-XSL<code class="uri">http://jimetevenard.com/ns/generate-xsl</code></a> ajoutés dans la
               transformation XSL. 
            </p>
            
            
            <p>Après compilation, on obtient une XSLT générée dans laquelle la valeur des variables,
               le
               résultat des appels de fonction, des appels de templates ou des structures de boucles
               et
               conditions annoté(e)s sont sérialisés.
            </p>
            
            
            <p>Il est également possible de prégénrer des templates spécifiques aux données attentues.</p>
            
            
            <p>L'objectif principal de ce système d'annotation est d'optimiser le traitement d'une
               XSLT
               sans affecter son fonctionnement d'origine.<br /> Ainsi cette XSLT reste maintenable et
               testable, et des test comparés de la <a href="#definition-xsl-source">XSL
                  source</a> et de la <a href="#definition-xsl-gen">XSL
                  générée</a> permettent d'identifier facilement les éventuels effets de
               bord de la pré-compilation. 
            </p>
            
            
            <h2>Exemple : </h2>
            
            <p>Le code suivant :</p>
            
            <pre><span class="elt-name">&lt;xsl:choose <span class="attr generate">generate:build="<span class="attr-value">#all</span>" </span></span><span class="elt-name">&gt;</span>
    <span class="elt-name">&lt;xsl:when <span class="attr">test="<span class="attr-value">foo:someXPath()[that/returns]/true()</span>" </span></span><span class="elt-name">&gt;</span>
        <span class="elt-name">&lt;xsl:value-of <span class="attr">select="<span class="attr-value">'Yep !'</span>" </span></span><span class="elt-name">/&gt;</span>
    <span class="elt-name">&lt;/xsl:when&gt;</span>
    <span class="elt-name">&lt;xsl:otherwhise</span><span class="elt-name">&gt;</span>
        <span class="elt-name">&lt;xsl:value-of <span class="attr">select="<span class="attr-value">'Nope !'</span>" </span></span><span class="elt-name">/&gt;</span>
    <span class="elt-name">&lt;/xsl:otherwhise&gt;</span>
<span class="elt-name">&lt;/xsl:choose&gt;</span>
</pre>
            <p>Devient, après compilation :</p>
            <pre><span class="elt-name">&lt;xsl:value-of <span class="attr">select="<span class="attr-value">'Yep !'</span>" </span></span><span class="elt-name">/&gt;</span>
</pre>
            
            <p>Dans cet exemple, on a exprimé par l'attribut <a href="#langnode-generate:build"><code class="attribute ref node">@generate:build</code></a> la
               volonté de pré-évaluer ce <code class="element node">&lt;xsl:choose/&gt;</code>.<br /> Ainsi, les différents
               <code>xsl:when/@test</code> ont été évalués et seul le code contenu dans le cas
               pertinent est retranscrit dans la <a href="#definition-xsl-gen">XSL
                  générée</a>
               
            </p>
            
            
            <h2>Contexte de la pré-compilation</h2>
            
            
            <p>
               La pré-compilation de la XSL est une phase lié au build d'un projet.<br />
               Elle est donc totalement ignorante des données ou du contexte d'éxécution.
               
            </p>
            
            
            <p>
               L'ensemble du <a href="https://www.w3.org/TR/xpath-30/#context" target="_blank">contexte XPath</a>, variables, paramètres, etc. disponibles pendant
               la phase de compilation
               est appelée <a href="#definition-contexte">contexte de génération</a><br />
               Le développeur qui met en place les annotations doit s'assurer que les expressions
               XPath évaluées sont effectivement évaluables dans ce contexte.
               
            </p>
            
            
            <p>
               Il peut s'aider en cela des éléments <a href="#langnode-generate:use-import"><code class="element ref node">&lt;generate:use-import/&gt;</code></a>,
               <a href="#langnode-generate:use-variable"><code class="element ref node">&lt;generate:use-variable/&gt;</code></a> et <a href="#langnode-generate:use-param"><code class="element ref node">&lt;generate:use-param/&gt;</code></a>,
               ainsi que de l'attribut <a href="#langnode-generate:use"><code class="attribute ref node">@generate:use</code></a> pour rendre visibles des variables, des paramètres ou des
               imports (et donc les variables globales, les paramètres et les fonctions qu'ils déclarent)
               dans le contexte de génération.
               
            </p>
            
            
            <h2>Modes de pré-compilation</h2>
            
            
            <p>
               Comme en XSLT, la notion de modes existe dans la pré-compilation XSLT.           
               
            </p>
            
            
            <p>En effet, considérons la cas suivant :</p>
            
            <pre><span class="elt-name">&lt;xsl:template <span class="attr">match="<span class="attr-value">/</span>" </span></span><span class="elt-name">&gt;</span>
    <span class="comment">&lt;!-- appel de template pré-compilé --&gt;</span>
    <span class="elt-name">&lt;xsl:call-template <span class="attr generate">generate:build="<span class="attr-value">#all</span>" </span> <span class="attr generate">generate:use-build-mode="<span class="attr-value">call-foo</span>" </span> <span class="attr">name="<span class="attr-value">foo</span>" </span></span><span class="elt-name">/&gt;</span>
<span class="elt-name">&lt;/xsl:template&gt;</span>
<span class="elt-name">&lt;xsl:template <span class="attr">name="<span class="attr-value">foo</span>" </span></span><span class="elt-name">&gt;</span>
    <span class="elt-name">&lt;xsl:sequence <span class="attr generate">generate:build="<span class="attr-value">call-foo</span>" </span> <span class="attr">select="<span class="attr-value">someXPath</span>" </span></span><span class="elt-name">/&gt;</span>
<span class="elt-name">&lt;/xsl:template&gt;</span>
</pre>
            
            <p>
               Dans le présent exemple, il est souhaité que l'élément <code class="element node">&lt;xsl:sequence/&gt;</code> du template
               foo ne soit pré-compilé que dans le cadre d'un appel lui même pré-compilé de ce template.
               
            </p>
            
            
            <p>
               Il se pourrait en effet que ce template soit appellé ailleurs dans la XSLT, indépendemment
               du
               processus de pré-compilation.
               
            </p>
            
            
            <p>
               Ici, l'élement <code class="element node">&lt;xsl:sequence/&gt;</code> ne sera pré-compilé que dans le mode <code>call-foo</code>,
               mode que nous avons spécifié via l'attribut <a href="#langnode-generate:use-build-mode"><code class="attribute ref node">@generate:use-build-mode</code></a> de <code class="element node">&lt;xsl:call-template/&gt;</code>
               
            </p>
            
            
            <h2>Implémentation XSLT</h2>
            
            
            <p>
               Le présent projet est une implémentation en XSLT de ce système d'annotations.
               
            </p>
            
            <div>
               Son utilisation se fait en deux étapes :
               
               
               <div class="case">
                  
                  <p>La transformation <code>generate.xsl</code> prend en entrée la transformation XSL source,
                     et produit en sortie une XSL intermédiaire.
                  </p>
                  
               </div>
               
               
               <div class="case">
                  
                  <p>
                     Cette XSL intermédiaire doit ensuite être appellée sans entrée (template inital "init"),
                     et produit en sortie la XSL pré-compilée.<br />
                     Si des paramètres ont été annotés comme visibles dans le contexte de génération, ils
                     peuvent être passés
                     à cette XSL intermédiaire.
                     
                  </p>
                  
                  
               </div>          
               
            </div>
            
            
            <div class="alert alert-info">
               
               <h3>Remarque :</h3>
               
               <p>En l'absence d'annotations, la XSL générée est identique (Au sens XML) à la XSL source.</p>
               
            </div>
            
            
            <h2>Lanceur Java</h2>
            
            
            <p>Une interface Java <code>com.jimetevenard.xslt.api.XSLGenerator</code> est fournie dans ce projet pour intégrer generate XSL à votre application.
            </p>
            
            
            <p>Une implémentation de cette interface basée sur Saxon PE (<code>com.jimetevenard.xslt.implSaxon.SaxonXSLTGenerator</code>) de cette interface est également fournie dans ce projet. 
            </p>
            
            
            
            
            <h2>Syntaxe du langage d'annotations</h2>
            
            
            <p>Les annotations consistent en éléments <code class="element node">&lt;generate:*/&gt;</code> et attributs <code class="attribute node">@generate:*</code>.
            </p>
            
            
            <p>
               Les attributs <code class="attribute node">@generate:*</code> se placent sur des instructions <code class="element node">&lt;xsl:*/&gt;</code>,
               pour spécifier le comportement, lors de la génération, des instructions sur lesquelles
               ils sont placés.
               
            </p>
            
            
            <p>
               Les éléments <code class="element node">&lt;generate:*/&gt;</code> doivent être des enfants de la racine <code class="element node">&lt;xsl:stylesheet/&gt;</code>
               ou d'autres éléments <code class="element node">&lt;generate:*/&gt;</code>.<br />
               Ceci pour ne pas perturber le comportement de la XSLT.
               
            </p>
            
            
            <div class="alert alert-info">
               
               <h3>Remarque :</h3>
               
               <p>
                  Une bonne pratique, pour faciliter la maintenance des XSL annotées, est de placer
                  systématiquement
                  les attributs <code class="attribute node">@generate:*</code> en premier dans l'élément.
                  
               </p>
               
               <p>
                  Ainsi, ils attireront plus facilement l'attention d'un développeurs n'ayant pas travaillé
                  sur l'annotation de la XSL
                  
               </p>
               
            </div>
            
            
            
            <h2>Attributs et éléments du langage</h2>
            
            
            
            <ul>
               
               <li>
                  <a href="#c-instructions">Compiler des instructions XSL</a>
                  
                  <ul>
                     
                     <li>Compiler une instruction par l’ajout de l’attribut <a href="#langnode-generate:build"><code class="attribute ref node">@generate:build</code></a></li>
                     
                     <li>Dupliquer un template avec l’élément <a href="#langnode-generate:copy-template"><code class="element ref node">&lt;generate:copy-template/&gt;</code></a>
                        
                        <ul>
                           
                           <li>
                              Modifier le templace dupliqué avec les éléments <a href="#langnode-generate:set-match"><code class="element ref node">&lt;generate:set-match/&gt;</code></a>,
                              <a href="#langnode-generate:set-mode"><code class="element ref node">&lt;generate:set-mode/&gt;</code></a>, <a href="#langnode-generate:set-priority"><code class="element ref node">&lt;generate:set-priority/&gt;</code></a>,
                              <a href="#langnode-generate:set-name"><code class="element ref node">&lt;generate:set-name/&gt;</code></a>, <a href="#langnode-generate:set-as"><code class="element ref node">&lt;generate:set-as/&gt;</code></a>,
                              <a href="#langnode-generate:set-visibility"><code class="element ref node">&lt;generate:set-visibility/&gt;</code></a>, <a href="#langnode-generate:redefine-variable"><code class="element ref node">&lt;generate:redefine-variable/&gt;</code></a>
                              et <a href="#langnode-generate:with-param"><code class="element ref node">&lt;generate:with-param/&gt;</code></a></li>
                           
                        </ul>
                        
                     </li>
                     
                     
                  </ul>
                  
               </li>
               
               <li>
                  <a href="#c-modes">Contrôle des modes de compilation</a>
                  
                  <ul>
                     
                     <li>Spécifier un mode de compilation  avec l'attribut <a href="#langnode-generate:use-build-mode"><code class="attribute ref node">@generate:use-build-mode</code></a></li>
                     
                     <li>La valeur de l'attribut <a href="#langnode-generate:build"><code class="attribute ref node">@generate:build</code></a> correspond au(x) mode(s) de compilation cible(s)
                     </li>
                     
                  </ul>
                  
               </li>
               
               <li>
                  <a href="#c-modifer">Modifer la structure de la XSLT</a>
                  
                  <ul>
                     
                     <li>Generer des variables (globales?(copy-template?)) avec l’élément <a href="#langnode-generate:variable"><code class="element ref node">&lt;generate:variable/&gt;</code></a></li>
                     
                     <li>Redefinir une variable existante avec <a href="#langnode-generate:redefine-variable"><code class="element ref node">&lt;generate:redefine-variable/&gt;</code></a></li>
                     
                     <li>Générer des imports avec l’élément <a href="#langnode-generate:import"><code class="element ref node">&lt;generate:import/&gt;</code></a></li>
                     
                     <li>Générer des parms globaux avec l’élément <a href="#langnode-generate:param"><code class="element ref node">&lt;generate:param/&gt;</code></a></li>
                     
                     <li>Ajouter un bloc de code avec l’élément <a href="#langnode-generate:target-block"><code class="element ref node">&lt;generate:target-block/&gt;</code></a></li>
                     
                  </ul>
                  
               </li>
               
               <li>
                  <a href="#c-structure">Structures de contrôle du langage d’annotations</a>
                  
                  <ul>
                     
                     <li>Structures conditionelles : éléments <a href="#langnode-generate:if"><code class="element ref node">&lt;generate:if/&gt;</code></a> et <a href="#langnode-generate:choose"><code class="element ref node">&lt;generate:choose/&gt;</code></a></li>
                     
                     <li>La boucle <a href="#langnode-generate:for-each"><code class="element ref node">&lt;generate:for-each/&gt;</code></a></li>
                     
                  </ul>
                  
               </li>
               
               <li>
                  <a href="#c-use">Utiliser des variables et paramètres dans le contexte de génération</a>
                  
                  <ul>
                     
                     <li>l’attribut <a href="#langnode-generate:use"><code class="attribute ref node">@generate:use</code></a></li>
                     
                     <li>les éléments <a href="#langnode-generate:use-variable"><code class="element ref node">&lt;generate:use-variable/&gt;</code></a>, <a href="#langnode-generate:use-import"><code class="element ref node">&lt;generate:use-import/&gt;</code></a> et <a href="#langnode-generate:use-param"><code class="element ref node">&lt;generate:use-param/&gt;</code></a></li>
                     
                  </ul>
                  
               </li>
               
               <li>
                  <a href="#c-ids">Identifier une instruction XSL</a>
                  
                  <ul>
                     
                     <li>Ajout d’un identifiant par l’attribut <a href="#langnode-generate:id"><code class="attribute ref node">@generate:id</code></a></li>
                     
                  </ul>
                  
               </li>
               
            </ul>
            
            
            
            
            <section id="c-instructions">
               
               
               <h3>Compiler des instructions XSLT</h3>
               
               
               <div class="langAttribute card langNode" data-doc-status="ok" data-implem-status="NA" id="langnode-generate:build">
                  <div class="card-body">
                     <h3 class="card-title">Attribute <code>generate:build</code></h3>
                     
                     <p>Cet attribut sert à indiquer que l'on souhaite pré-compiler l'instruction.</p>
                     
                     <div>Il peut s'ajouter :
                        
                        <div class="case">
                           
                           <h4>
                              Sur les éléments <code class="element node">&lt;xsl:variable/&gt;</code>
                              
                           </h4>
                           
                           <p>Le resultat généré est alors une copie de l'instruction <code class="element node">&lt;xsl:variable/&gt;</code>
                              dont le contenu est un <code>sequence constructor</code> équivalent à la sérialisation
                              du resultat de l'évaluation de l'attribut <code class="attribute node">@select</code> ou du contenu initial de 
                              l'élément <code class="element node">&lt;xsl:variable/&gt;</code>
                              
                           </p>
                           
                        </div>
                        
                        <div class="case">
                           
                           <h4>Sur les éléments <code class="element node">&lt;xsl:value-of/&gt;</code></h4>
                           
                           <p>TODO vérifier l'implémentation...</p>
                           
                        </div>
                        
                        <div class="case">
                           
                           <h4>Sur les éléments <code class="element node">&lt;xsl:call-template/&gt;</code></h4>
                           
                           <p>
                              Nous avons la possibilité de pré-compiler un appel de template
                              nommé de type <code>&lt;xsl:call-template name="foo" /&gt;</code>
                              
                           </p>
                           
                           <p>
                              Le résultat dans la xsl-générée est la serialisation de la séquence
                              de retour du template.
                              
                           </p>
                           
                           <p>
                              Peut être complété par un attribut <a href="#langnode-generate:use-build-mode"><code class="attribute ref node">@generate:use-build-mode</code></a>.<br />
                              Les paramètres spécifés s'appliquent<br />
                              TODO compléter ou écrire un paragraphe dédié.
                              
                           </p>
                           
                        </div>
                        
                        <div class="case">
                           
                           <h4>Sur les éléments <code class="element node">&lt;xsl:with-param/&gt;</code></h4>
                           
                           <p>Comportement identique au cas des <code class="element node">&lt;xsl:variable/&gt;</code> décrit ci-dessus
                           </p>
                           
                        </div>
                        
                        <div class="case">
                           
                           <h4>Sur les éléments <code class="element node">&lt;xsl:if/&gt;</code> et <code class="element node">&lt;xsl:choose/&gt;</code>&gt;
                           </h4>
                           
                           <p>Le(s) attributs <code class="attribute node">@test</code> correspondant alors sont évalués.
                           </p>
                           
                           <p>Les blocs de codes pertinents sont reprodutis dans la XSL générée.</p>
                           
                        </div>
                        
                        <div class="case">
                           
                           <h4>Sur les éléments <code class="element node">&lt;xsl:for-each/&gt;</code></h4>
                           
                           <p>Le contenu de bloc est reproduit et décliné pour chaque élément de la séquence 
                              spécifiée en <code class="attribute node">@select</code></p>
                           
                        </div>
                        
                     </div>
                     
                     
                     <p>La valeur de l'attribut correspond au(x) mode(s) de génération dans lesquels la
                        valeur de l'instruction doit être calculée.
                     </p>
                     
                  </div>
               </div>
               
               <div class="langElement card langNode" data-doc-status="ok" data-implem-status="NA" id="langnode-generate:copy-template">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:copy-template</code></h3>
                     
                     <div>Duplique dans la <a href="#definition-xsl-gen">XSL générée</a> un
                        <code class="element node">&lt;xsl:template/&gt;</code> de la <a href="#definition-xsl-source">XSL
                           source</a> identifié par : 
                        <div class="case">Une référence à son éventuel
                           attribut<a href="#langnode-"><code class=" ref node"></code></a> exprimée sous forme d'un
                           attribut <code class="attribute node">@id</code></div>
                        
                        <div class="case">Une référence à son <code class="attribute node">@name</code> exprimée via un attribut
                           <code class="attribute node">@name</code> sous réserve qu'il soit présent et
                           unique.
                        </div>
                        
                     </div>
                     
                     <div class="alert alert-info"> Cet élément accepte les enfants <a href="#langnode-generate:set-match"><code class="element ref node">&lt;generate:set-match/&gt;</code></a>
                        <a href="#langnode-generate:set-mode"><code class="element ref node">&lt;generate:set-mode/&gt;</code></a>
                        <a href="#langnode-generate:set-priority"><code class="element ref node">&lt;generate:set-priority/&gt;</code></a>
                        <a href="#langnode-generate:set-name"><code class="element ref node">&lt;generate:set-name/&gt;</code></a>
                        <a href="#langnode-generate:set-as"><code class="element ref node">&lt;generate:set-as/&gt;</code></a>
                        <a href="#langnode-generate:set-visibility"><code class="element ref node">&lt;generate:set-visibility/&gt;</code></a> qui permettent de redifinir les
                        attributs correspondants du template. 
                     </div>
                     
                  </div>
               </div>
               
               
               <div class="langNodeSet card langNode" data-doc-status="ok" data-implem-status="NA">
                  <div class="card-body">
                     <ul class="card-title">
                        <li class="langElement tiny langNode" id="langnode-generate:set-match">Element <code>generate:set-match</code></li>
                        <li class="langElement tiny langNode" id="langnode-generate:set-mode">Element <code>generate:set-mode</code></li>
                        <li class="langElement tiny langNode" id="langnode-generate:set-priority">Element <code>generate:set-priority</code></li>
                        <li class="langElement tiny langNode" id="langnode-generate:set-name">Element <code>generate:set-name</code></li>
                        <li class="langElement tiny langNode" id="langnode-generate:set-as">Element <code>generate:set-as</code></li>
                        <li class="langElement tiny langNode" id="langnode-generate:set-visibility">Element <code>generate:set-visibility</code></li>
                     </ul>
                     <p>Ces éléments permettent, dans un <a href="#langnode-generate:copy-template"><code class="element ref node">&lt;generate:copy-template/&gt;</code></a> de modifier
                        l'attribut correspondant du template.
                     </p>
                  </div>
               </div>
               
               
               <div class="langElement card langNode" data-doc-status="todo" data-implem-status="0" id="langnode-generate:with-param">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:with-param</code></h3>
                     
                     <p>TODO !</p>
                     
                  </div>
               </div>
               
               
               
               
            </section>
            
            
            
            <section id="c-modifer">
               
               
               <h3>Modifer la structure de la XSLT</h3>
               
               
               <div class="langElement card langNode" data-doc-status="toreview" data-implem-status="NA" id="langnode-generate:variable">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:variable</code></h3>
                     
                     <p>Crée une <code class="element node">&lt;xsl:variable/&gt;</code> dans la <a href="#definition-xsl-gen">XSL
                           générée</a></p>
                     
                     <p>L'évaluation ou non de la variable durant la compilation peut être exprimée par
                        l'attribut <a href="#langnode-generate:build"><code class="attribute ref node">@generate:build</code></a></p>
                     
                  </div>
               </div>
               
               
               <div class="langElement card langNode" data-doc-status="toreview" data-implem-status="NA" id="langnode-generate:redefine-variable">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:redefine-variable</code></h3>
                     
                     <div>Redéfinit une variable déclarée dans la <a href="#definition-xsl-source">XSL
                           source</a> identifiée par : 
                        <div class="case">Un attribut
                           <code class="attribute node">@id</code>, traité comme référence à l'attribut <a href="#langnode-generate:id"><code class="attribute ref node">@generate:id</code></a> de la variable
                        </div>
                        
                        <div class="case">Un attribut <code class="attribute node">@name</code> référençant le nom de la variable.
                           Dans ce second cas, l'élément <a href="#langnode-generate:redefine-variable"><code class="element ref node">&lt;generate:redefine-variable/&gt;</code></a> doit être placé dans le <i>scope</i> de la variable.
                        </div>
                        
                     </div>
                     
                  </div>
               </div>
               
               
               
               <div class="langElement card langNode" data-doc-status="toreview" data-implem-status="NA" id="langnode-generate:import">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:import</code></h3> Ajoute un élément
                     <code class="element node">&lt;xsl:import/&gt;</code> à la <a href="#definition-xsl-gen">XSL
                        générée</a>. 
                  </div>
               </div>
               
               
               <div class="langElement card langNode" data-doc-status="toreview" data-implem-status="NA" id="langnode-generate:param">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:param</code></h3> Ajoute un élément
                     <code class="element node">&lt;xsl:param/&gt;</code> global à la <a href="#definition-xsl-gen">XSL
                        générée</a>. 
                  </div>
               </div>
               
               
               <div class="langElement card langNode" data-doc-status="toreview" data-implem-status="NA" id="langnode-generate:target-block">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:target-block</code></h3>
                     
                     <p>Le contenu de cet élément seront présentent dans la <a href="#definition-xsl-gen">XSL générée</a></p>
                     
                  </div>
               </div>
               
               
            </section>
            
            
            <section id="c-modes">
               
               <h3>Contrôle des modes de compilation</h3>
               
               
               
               <div class="langAttribute card langNode" data-doc-status="tocomplete" data-implem-status="NA" id="langnode-generate:use-build-mode">
                  <div class="card-body">
                     <h3 class="card-title">Attribute <code>generate:use-build-mode</code></h3>
                     
                     <p>Permet de spécifier le mode de génération à utiliser lors de la
                        précompilation d'un appel de template (<code class="element node">&lt;xsl:call-template/&gt;</code>)
                        ou d'une copie de template. (<a href="#langnode-generate:copy-template"><code class="element ref node">&lt;generate:copy-template/&gt;</code></a>)
                     </p>
                     
                  </div>
               </div>
               
               
               
            </section>
            
            
            
            <section id="c-structure">
               
               
               <h3>Structures de contrôle du langage d’annotations</h3>
               
               
               
               
               
               <div class="langElement card langNode" data-doc-status="old" data-implem-status="NA" id="langnode-generate:for-each">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:for-each</code></h3>
                     
                     <p>Itère sur chaque élément de la séquence exprimée dans l'attribut
                        <code class="attribute node">@select</code>.
                     </p>
                     
                     <p>La valeur de cet attribut est évaluée dans le <a href="#definition-contexte">contexte de génération</a>.
                     </p>
                     
                     <div>A chaque itération : 
                        <div class="case">Les éléments <code class="element node">&lt;xsl:*/&gt;</code> à l'intérieur du
                           bloc sont dupliqués, en tenat compte des <code class="element node">&lt;generate:*/&gt;</code> et
                           <code class="attribute node">@generate:*</code> qu'ils contiennent.
                        </div>
                        
                        <div class="case">les instructions <code class="element node">&lt;generate:*/&gt;</code> sont éxécutées.
                        </div>
                        
                     </div>
                     
                  </div>
               </div>
               
               
               <div class="langElement card langNode" data-doc-status="old" data-implem-status="NA" id="langnode-generate:if">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:if</code></h3>
                     
                     <div>Si la condition exprimée dans <code class="attribute node">@test</code> est vraie, 
                        <div class="case">Les
                           éléments <code class="element node">&lt;xsl:*/&gt;</code> à l'intérieur du bloc sont dupliqués, en tenat
                           compte des <code class="element node">&lt;generate:*/&gt;</code> et <code class="attribute node">@generate:*</code>
                           qu'ils contiennent.
                        </div>
                        
                        <div class="case">les instructions <code class="element node">&lt;generate:*/&gt;</code> sont éxécutées.
                        </div>
                        
                     </div>
                     
                     <p>La valeur de l'attribut <code class="attribute node">@test</code> est évaluée dans le
                        <a href="#definition-contexte">contexte de génération</a>.
                     </p>
                     
                  </div>
               </div>
               
               
               <div class="langElement card langNode" data-doc-status="todo" data-implem-status="0" id="langnode-generate:choose">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:choose</code></h3>
                     
                     <p>TODO</p>
                     
                  </div>
               </div>
               
               
               
            </section>
            
            
            <section id="c-use">
               
               
               <h3>Utiliser des variables et paramètres dans le contexte de génération</h3>
               
               
               <div class="langAttribute card langNode" data-doc-status="tocomplete" data-implem-status="NA" id="langnode-generate:use">
                  <div class="card-body">
                     <h3 class="card-title">Attribute <code>generate:use</code></h3>
                     
                     <p>Associé à un <code class="element node">&lt;xsl:import/&gt;</code> ou à une
                        <code class="element node">&lt;xsl:variable/&gt;</code> permet de rendre ce·tte dernier·e visible
                        dans le <a href="#definition-contexte">contexte de
                           génération</a>.
                     </p>
                     
                  </div>
               </div>
               
               
               
               <div class="langElement card langNode" data-doc-status="pending" data-implem-status="NA" id="langnode-generate:use-import">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:use-import</code></h3>
                     
                     <p>Importe une Transformation XSL externe et la rend visible dans le <a href="#definition-contexte">contexte de génération</a>.
                     </p>
                     
                     
                     <div>La XSL cible peut être référencée : 
                        <div class="case">Via un attribut <code class="attribute node">@href</code>
                           contenant l'URI de la feuille de style importée
                        </div>
                        
                        <div class="case">Via un attribut <code class="attribute node">@id</code>, traité comme aune référence à
                           l'attribut <a href="#langnode-generate:id"><code class="attribute ref node">@generate:id</code></a> d'un import déclaré la
                           <a href="#definition-xsl-source">XSL source</a></div>
                        
                     </div>
                     
                     
                     <p>Les variables, paramètres, templates, fonctions... déclarées dans la XSL importée
                        sont visibles dans le <a href="#definition-contexte">contexte de
                           génération</a></p>
                     
                     
                     <div class="alert alert-warning">
                        
                        <p> Il appartient au développeur de s'assurer que les expressions XPath exprimées
                           dans la XSL importée sont effectivement evaluables dans le <a href="#definition-contexte">contexte de génération</a>. 
                        </p>
                        
                        <p>L'utilisation de <a href="#langnode-generate:use"><code class="attribute ref node">@generate:use</code></a> ou <a href="#langnode-generate:use-variable"><code class="element ref node">&lt;generate:use-variable/&gt;</code></a> peut, par exemple, être néscéssaire.
                        </p>
                        
                        
                     </div>
                     
                  </div>
               </div>
               
               
               <div class="langElement card langNode" data-doc-status="pending" data-implem-status="NA" id="langnode-generate:use-param">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:use-param</code></h3>
                     
                     <p>
                        Permet d'utilser un paramètre visible uniquement dans le <a href="#definition-contexte">contexte de génération.</a>
                        
                     </p>
                     
                     <div class="alert alert-warning">TODO, non implémenté !</div>
                     
                  </div>
               </div>
               
               
               <div class="langElement card langNode" data-doc-status="pending" data-implem-status="NA" id="langnode-generate:use-variable">
                  <div class="card-body">
                     <h3 class="card-title">Element <code>generate:use-variable</code></h3>
                     
                     <p>Définit une variable évaluée et visible dans le <a href="#definition-contexte">contexte de génération</a>.
                     </p>
                     
                     <div class="alert alert-warning">La/les expressions XPath exprimées pour définir la valeur de la variable
                        doivent être effectivement évaluables dans le contexte de génération.
                     </div>
                     
                  </div>
               </div>
               
               
            </section>
            
            
            
            
            <section id="c-ids">
               
               <h3>Identifier une instruction XSL</h3>
               
               
               <div class="langAttribute card langNode" data-doc-status="todo" data-implem-status="NA" id="langnode-generate:id">
                  <div class="card-body">
                     <h3 class="card-title">Attribute <code>generate:id</code></h3>
                     
                     <p>Permet d'attribuer un identifiant à un élément <code class="element node">&lt;xsl:*/&gt;</code>.
                     </p>
                     
                     <p>Cet identifiant peut être utilisé pour le designer dans une
                        annotation<code class="element node">&lt;generate:*/&gt;</code>.<br />
                        Exemple :
                        
                     </p>
                     <pre><span class="elt-name">&lt;xsl:template <span class="attr generate">generate:id="<span class="attr-value">bar</span>" </span> <span class="attr">match="<span class="attr-value">/</span>" </span></span><span class="elt-name">&gt;</span>
    <span class="comment">&lt;!-- (...) --&gt;</span>
<span class="elt-name">&lt;/xsl:template&gt;</span>
<span class="elt-name">&lt;generate:remove <span class="attr">idRef="<span class="attr-value">bar</span>" </span></span><span class="elt-name">/&gt;</span>
</pre>
                     </div>
               </div>
               
               
            </section>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <h2>Definitions</h2>
            
            
            <div class="definition" id="definition-contexte">
               
               <h3>Contexte de génération</h3>
               
               <p>Bla Bla bla...</p>
               
            </div>
            
            
            <div class="definition" id="definition-xsl-source">
               
               <h3>XSL Source</h3>
               
               <p>La XSL source (TODO rédiger)</p>
               
            </div>
            
            
            <div class="definition" id="definition-xsl-gen">
               
               <h3>XSL Générée</h3>
               
               <p>La XSL générée (TODO rédiger)</p>
               
            </div>
            
            
            
            
            
            
         </section>
         
         
         
         
      </main>
   </body>
</html>
